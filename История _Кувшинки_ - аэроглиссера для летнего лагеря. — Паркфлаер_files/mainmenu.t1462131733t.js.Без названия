function provider_click(a){var b=a.attr("id"),c=$("a.provider_active");if(c.length&&a[0]!=c[0]){$("li[id^=catalog_provider] ul ul:visible").hide();$("#catalog a[id^=category][class*=active]").removeClass("active");$("a.provider").removeClass("provider_active").removeClass("btn-provider_active");$("ul#providers li a").each(function(){prov=$(this).attr("id");$("#catalog_"+prov).hide()});a.addClass("provider_active").addClass("btn-provider_active");$("#catalog_"+b).fadeIn("slow")}return b}
function setMenu(a){if($.hashdata.get("type")=="provider")provider_click(a);else{var b=a.parent(),c=$(a.parents("[id*=catalog_provider]")[0]).attr("id");providerName=/catalog_(.+)/.exec(c)[1];providerObject=$("#"+providerName);provider_click(providerObject);$("#menu_container .current").removeClass("current");$("#"+c+" a.active").each(function(){$(this).removeClass("active");$(this).attr("id")&&$(this).attr("id")!=a.attr("id")&&$(this).parent().children("ul").hide()});a.parent();a.parentsUntil("#catalog").each(function(){$(this).children("a").addClass("active");
$(this).parent().children("ul").show()});a.hasClass("first")||a.addClass("current");b.children("ul:eq(0)").slideToggle(300);click_a=b.children('[id*="category_"]');child_ul_state=b.children("ul").css("display");child_ul_state=="none"&&click_a.removeClass("active")}}function getCategoryId(a){return/category_(\d+)/.exec(a)[1]}function getProviderId(a){return/(provider_)?(\d+)/.exec(a)[2]}
function ajaxProductList(a){function b(f){$("#content_cont").empty();paginator_config=false;category_category=true;var d;if($("#product_list").length){d=$("#product_list");d.empty()}else{d=$('<div id="product_list" />');$("#content_cont").append(d)}d.append(f);$.hashdata.get("instock")=="on"&&$("input[name=instock]").attr("checked","checked");d=$("#"+a.type+"_"+a.category);var i=d.text();setMenu(d);document.title=i;category_category||scrollTo(0,0);category_cache[g]||(category_cache[g]=f);window.yaCounter&&
yaCounter.hit(location.href,{title:i})}a=$.extend($.hashdata.data,a);var c=a.category,h=a.type||"category",e=a.page||"first",g=h+c+e+(a.instock||"")+(a.sortby||"");a.page=e;a.type=h;$.hashdata.setMulti(a,true);if(content=category_cache[g])b(content);else{e={url:"/category/"+c+"/?"+$.param(a),user_id:$.cookie("user_id"),ajax:true};if(h!="provider"&&!$("#category_"+c).length)e.catalogFull=true;c="/"+language+"/node_product/category_categories?"+$.param(a);$.ajax({type:"POST",beforeSend:function(f,d){$("#content_cont").paintLoader();
ajaxBeforeSend(f,d)},cache:false,url:c,data:e,success:b,error:function(){$("#content_cont").empty();$("#content_cont").append("<div>"+gettext("\u0418\u0437\u0432\u0438\u043d\u0438\u0442\u0435, \u0443 \u043d\u0430\u0441 \u043f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043f\u044b\u0442\u043a\u0435 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438.<br>\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u043f\u043e\u0437\u0436\u0435.")+
"</div>");window.scrollTo(0,0)}})}}$(document).ready(function(){$('#main_menu li[class!="menu_sep"]').hover(function(){$(this).addClass("active");$(this).prev("li").addClass("active");$(this).next("li").addClass("active")},function(){$(this).removeClass("active");$(this).prev("li").removeClass("active");$(this).next("li").removeClass("active")})});$(window).on("realhashchange",function(){if(category=$.hashdata.get("category"))ajaxProductList({category:category})});
$(document).on("click",".category_click_path",function(a){if(a.which==1){a=$(this).data("id-category");var b=$(this).data("type")||"category";ajaxProductList({category:a,type:b,page:"first"},true);return false}});$(document).on("click","#menu_container ul#catalog li ul li a",function(){var a=getCategoryId($(this).attr("id"));ajaxProductList({category:a,type:"category",page:"first"});return false});
$(document).on("click",".category_process",function(a){if(a.which==1){a=$(this).data("id-category");ajaxProductList({category:a,page:"first",type:"category"});return false}});$("#menu_container ul#providers li a").click(function(){var a=getProviderId($(this).attr("id"));ajaxProductList({category:a,type:"provider"});return false});var open_menu,category_cache={};
if(category=$.hashdata.get("category")){var type=/provider_(.+)/.test(category)||$.hashdata.get("type")=="provider"?"provider":"category";category=type=="provider"?getProviderId(category):category;ajaxProductList({category:category,type:type},true);open_menu="#category_"+category;/catalog_provider_.+/.test($(open_menu).parents('li[id^="catalog_provider"]').attr("id"))||$(open_menu).addClass("current")}else if(category=/^[\/\d]*category.*\/(\d+)\/$/.exec(window.location.pathname)||curr_category!=""){var toHash=
{};if(category){toHash.category=category[1];var page=/.*page=(\d+\%2C\d+\%2C\d+).*/.exec(window.location.href)||[1,"first"];toHash.page=page[1];$.hashdata.setMulti(toHash,true)}open_menu="#category_"+curr_category;(prov=$(open_menu).parents('li[id^="catalog_provider_"]').attr("id"))||$(open_menu).addClass("current");prov=prov.replace("catalog_","");provider_click($("#"+prov))};
