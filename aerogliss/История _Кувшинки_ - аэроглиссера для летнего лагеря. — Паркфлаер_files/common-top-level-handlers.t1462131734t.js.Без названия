$(function(){$(document).one("mouseenter",'[data-toggle="tooltip"]',function(){$(this).not("[data-original-title]").tooltip({animation:false}).tooltip("show")});$(document).on("click",".vote-plus, .vote-minus",function(){var b=$(this),a=b.parents(".post"),c=parseInt(a.data("post-id"),10);if(!isFinite(c))throw Error("\u041d\u0443\u0436\u0435\u043d Number, \u0430 \u043d\u0435 `"+c+"` ("+a.data("post-id")+").");b={id:c,delta:b.hasClass("vote-minus")?-1:1,recalcPayments:true};PF.xhr.expect("json").post("/"+
language+"/node_blog/vote",b,function(e,d){if(!d.success)return showError(d.errcode);a.find(".post-score span").removeClass("vote-score-positive vote-score-negative").addClass("vote-score-"+(d.score>=0?"positive":"negative")).text((d.score>=0?"+":"")+d.score).attr("data-original-title","+"+d.pluscnt+" / "+d.minuscnt);a.find(".post-footer-paid a:first").data("popover-html",d.paymentsTblMessage);a.find(".post-footer-paid-amount").text(d.paidStr)})});$(document).on("click",".js-fav",function(){var b=
$(this);if(!b.data("waiting-xhr")){var a=b.children("i"),c=b.children(".js-fav-faves"),e=a.hasClass("icon-star"),d=e?"icon-star":"icon-star-empty",h=parseInt(c.text(),10);a.removeClass("icon-star icon-star-empty").addClass(e?"icon-star-empty":"icon-star");c.text(e?h-1:h+1);b.data("waiting-xhr",true);PF.xhr.post("/"+language+"/node/blog/entries/"+b.data("post-id")+"/fave",function(g,f){g=g||f&&!f.ok;b.data("waiting-xhr",false);var j=function(){var i=f&&f.result?f.result.faved:!e;return g?i?gettext('\u041e\u0448\u0438\u0431\u043a\u0430. \u0417\u0430\u043f\u0438\u0441\u044c <i>\u043d\u0435</i>&nbsp;\u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430 \u0432&nbsp;<a href="/blogs/favorites/">\u0438\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435</a>.'):
gettext('\u041e\u0448\u0438\u0431\u043a\u0430. \u0417\u0430\u043f\u0438\u0441\u044c <i>\u043d\u0435</i>&nbsp;\u0443\u0434\u0430\u043b\u0435\u043d\u0430 \u0438\u0437&nbsp;<a href="/blogs/favorites/">\u0438\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e</a>.'):i?gettext('\u0417\u0430\u043f\u0438\u0441\u044c \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430 \u0432&nbsp;<a href="/blogs/favorites/">\u0438\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435</a>.'):gettext('\u0417\u0430\u043f\u0438\u0441\u044c \u0443\u0434\u0430\u043b\u0435\u043d\u0430 \u0438\u0437&nbsp;<a href="/blogs/favorites/">\u0438\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e</a>.')};
if(g){a.removeClass("icon-star icon-star-empty").addClass(d);c.text(h);return g.jqXhr&&g.jqXhr.status===401?showLoginDialog({redirect_to:String(window.location)}):PF.showMessage(j())}a.removeClass("icon-star icon-star-empty").addClass(f.result.faved?"icon-star":"icon-star-empty");c.text(f.result.faves);PF.showMessage(j(),3)})}});$(document).one("mouseenter mousedown","a[href]",function(){var b=$(this);if(b.data("ref-link-changed"))return true;else b.data("ref-link-changed",true);var a=PF.node.url.parse(String(this),
true,true),c={None:-1,HobbyKing:function(){if(!a.query)a.query={};delete a.search;a.query.aff="321907";return PF.node.url.format(a)}};if(this.hostname===window.location.hostname)return true;var e;e=/hobbyking.com$/i.test(this.hostname)?c.HobbyKing:c.None;if(e===c.None)return true;b.attr("href",e());return true})});
