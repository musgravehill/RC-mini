(function(){var g={},t=this,x=t.async;typeof module!="undefined"&&module.exports?module.exports=g:t.async=g;g.noConflict=function(){return t.async=x,g};var n=function(b,c){if(b.forEach)return b.forEach(c);for(var d=0;d<b.length;d+=1)c(b[d],d,b)},o=function(b,c){if(b.map)return b.map(c);var d=[];return n(b,function(a,f,e){d.push(c(a,f,e))}),d},y=function(b,c,d){return b.reduce?b.reduce(c,d):(n(b,function(a,f,e){d=c(d,a,f,e)}),d)},s=function(b){if(Object.keys)return Object.keys(b);var c=[],d;for(d in b)b.hasOwnProperty(d)&&
c.push(d);return c};typeof process=="undefined"||!process.nextTick?g.nextTick=function(b){setTimeout(b,0)}:g.nextTick=process.nextTick;g.forEach=function(b,c,d){d=d||function(){};if(!b.length)return d();var a=0;n(b,function(f){c(f,function(e){e?(d(e),d=function(){}):(a+=1,a===b.length&&d())})})};g.forEachSeries=function(b,c,d){d=d||function(){};if(!b.length)return d();var a=0,f=function(){c(b[a],function(e){e?(d(e),d=function(){}):(a+=1,a===b.length?d():f())})};f()};g.forEachLimit=function(b,c,d,
a){a=a||function(){};if(!b.length||c<=0)return a();var f=0,e=0,h=0;(function i(){if(f===b.length)return a();for(;h<c&&e<b.length;){d(b[e],function(j){j?(a(j),a=function(){}):(f+=1,h-=1,f===b.length?a():i())});e+=1;h+=1}})()};var m=function(b){return function(){var c=Array.prototype.slice.call(arguments);return b.apply(null,[g.forEach].concat(c))}},r=function(b){return function(){var c=Array.prototype.slice.call(arguments);return b.apply(null,[g.forEachSeries].concat(c))}},k=function(b,c,d,a){var f=
[];c=o(c,function(e,h){return{index:h,value:e}});b(c,function(e,h){d(e.value,function(i,j){f[e.index]=j;h(i)})},function(e){a(e,f)})};g.map=m(k);g.mapSeries=r(k);g.reduce=function(b,c,d,a){g.forEachSeries(b,function(f,e){d(c,f,function(h,i){c=i;e(h)})},function(f){a(f,c)})};g.inject=g.reduce;g.foldl=g.reduce;g.reduceRight=function(b,c,d,a){b=o(b,function(f){return f}).reverse();g.reduce(b,c,d,a)};g.foldr=g.reduceRight;k=function(b,c,d,a){var f=[];c=o(c,function(e,h){return{index:h,value:e}});b(c,
function(e,h){d(e.value,function(i){i&&f.push(e);h()})},function(){a(o(f.sort(function(e,h){return e.index-h.index}),function(e){return e.value}))})};g.filter=m(k);g.filterSeries=r(k);g.select=g.filter;g.selectSeries=g.filterSeries;k=function(b,c,d,a){var f=[];c=o(c,function(e,h){return{index:h,value:e}});b(c,function(e,h){d(e.value,function(i){i||f.push(e);h()})},function(){a(o(f.sort(function(e,h){return e.index-h.index}),function(e){return e.value}))})};g.reject=m(k);g.rejectSeries=r(k);k=function(b,
c,d,a){b(c,function(f,e){d(f,function(h){h?(a(f),a=function(){}):e()})},function(){a()})};g.detect=m(k);g.detectSeries=r(k);g.some=function(b,c,d){g.forEach(b,function(a,f){c(a,function(e){e&&(d(true),d=function(){});f()})},function(){d(false)})};g.any=g.some;g.every=function(b,c,d){g.forEach(b,function(a,f){c(a,function(e){e||(d(false),d=function(){});f()})},function(){d(true)})};g.all=g.every;g.sortBy=function(b,c,d){g.map(b,function(a,f){c(a,function(e,h){e?f(e):f(null,{value:a,criteria:h})})},
function(a,f){if(a)return d(a);d(null,o(f.sort(function(e,h){var i=e.criteria,j=h.criteria;return i<j?-1:i>j?1:0}),function(e){return e.value}))})};g.auto=function(b,c){c=c||function(){};var d=s(b);if(!d.length)return c(null);var a={},f=[],e=function(i){f.unshift(i)},h=function(){n(f.slice(0),function(i){i()})};e(function(){s(a).length===d.length&&(c(null,a),c=function(){})});n(d,function(i){var j=b[i]instanceof Function?[b[i]]:b[i],q=function(p){if(p){c(p);c=function(){}}else{var l=Array.prototype.slice.call(arguments,
1);l.length<=1&&(l=l[0]);a[i]=l;h()}},u=j.slice(0,Math.abs(j.length-1))||[],v=function(){return y(u,function(p,l){return p&&a.hasOwnProperty(l)},true)};if(v())j[j.length-1](q,a);else{var w=function(){if(v()){for(var p=w,l=0;l<f.length;l+=1)if(f[l]===p){f.splice(l,1);break}j[j.length-1](q,a)}};e(w)}})};g.waterfall=function(b,c){c=c||function(){};if(!b.length)return c();var d=function(a){return function(f){if(f){c(f);c=function(){}}else{var e=Array.prototype.slice.call(arguments,1),h=a.next();h?e.push(d(h)):
e.push(c);g.nextTick(function(){a.apply(null,e)})}}};d(g.iterator(b))()};g.parallel=function(b,c){c=c||function(){};if(b.constructor===Array)g.map(b,function(a,f){a&&a(function(e){var h=Array.prototype.slice.call(arguments,1);h.length<=1&&(h=h[0]);f.call(null,e,h)})},c);else{var d={};g.forEach(s(b),function(a,f){b[a](function(e){var h=Array.prototype.slice.call(arguments,1);h.length<=1&&(h=h[0]);d[a]=h;f(e)})},function(a){c(a,d)})}};g.series=function(b,c){c=c||function(){};if(b.constructor===Array)g.mapSeries(b,
function(a,f){a&&a(function(e){var h=Array.prototype.slice.call(arguments,1);h.length<=1&&(h=h[0]);f.call(null,e,h)})},c);else{var d={};g.forEachSeries(s(b),function(a,f){b[a](function(e){var h=Array.prototype.slice.call(arguments,1);h.length<=1&&(h=h[0]);d[a]=h;f(e)})},function(a){c(a,d)})}};g.iterator=function(b){var c=function(d){var a=function(){return b.length&&b[d].apply(null,arguments),a.next()};return a.next=function(){return d<b.length-1?c(d+1):null},a};return c(0)};g.apply=function(b){var c=
Array.prototype.slice.call(arguments,1);return function(){return b.apply(null,c.concat(Array.prototype.slice.call(arguments)))}};k=function(b,c,d,a){var f=[];b(c,function(e,h){d(e,function(i,j){f=f.concat(j||[]);h(i)})},function(e){a(e,f)})};g.concat=m(k);g.concatSeries=r(k);g.whilst=function(b,c,d){b()?c(function(a){if(a)return d(a);g.whilst(b,c,d)}):d()};g.until=function(b,c,d){b()?d():c(function(a){if(a)return d(a);g.until(b,c,d)})};g.queue=function(b,c){var d=0,a={tasks:[],concurrency:c,saturated:null,
empty:null,drain:null,push:function(f,e){f.constructor!==Array&&(f=[f]);n(f,function(h){a.tasks.push({data:h,callback:typeof e=="function"?e:null});a.saturated&&a.tasks.length==c&&a.saturated();g.nextTick(a.process)})},process:function(){if(d<a.concurrency&&a.tasks.length){var f=a.tasks.shift();a.empty&&a.tasks.length==0&&a.empty();d+=1;b(f.data,function(){d-=1;f.callback&&f.callback.apply(f,arguments);a.drain&&a.tasks.length+d==0&&a.drain();a.process()})}},length:function(){return a.tasks.length},
running:function(){return d}};return a};m=function(b){return function(c){var d=Array.prototype.slice.call(arguments,1);c.apply(null,d.concat([function(a){var f=Array.prototype.slice.call(arguments,1);typeof console!="undefined"&&(a?console.error&&console.error(a):console[b]&&n(f,function(e){console[b](e)}))}]))}};g.log=m("log");g.dir=m("dir");g.memoize=function(b,c){var d={},a={};c=c||function(e){return e};var f=function(){var e=Array.prototype.slice.call(arguments),h=e.pop(),i=c.apply(null,e);i in
d?h.apply(null,d[i]):i in a?a[i].push(h):(a[i]=[h],b.apply(null,e.concat([function(){d[i]=arguments;var j=a[i];delete a[i];for(var q=0,u=j.length;q<u;q++)j[q].apply(null,arguments)}])))};return f.unmemoized=b,f};g.unmemoize=function(b){return function(){return(b.unmemoized||b).apply(null,arguments)}}})();
